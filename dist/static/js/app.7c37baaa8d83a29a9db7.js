webpackJsonp([1],{"7zck":function(t,e){},A0Cv:function(t,e){},FUWc:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KIDxnPgogIDx0aXRsZT5iYWNrZ3JvdW5kPC90aXRsZT4KICA8cmVjdCB4PSItMSIgeT0iLTEiIHdpZHRoPSIxNTIiIGhlaWdodD0iMTUyIiBpZD0iY2FudmFzX2JhY2tncm91bmQiIGZpbGw9Im5vbmUiLz4KIDwvZz4KCiA8Zz4KICA8dGl0bGU+TGF5ZXIgMTwvdGl0bGU+CiAgPHJlY3Qgc3Ryb2tlLXdpZHRoPSIwLjMiIGZpbGw9ImJsYWNrIiB4PSI2MC42Mzg2NzUiIHk9IjEwMyIgd2lkdGg9IjE1LjUiIGhlaWdodD0iMC41IiBpZD0ic3ZnXzMzIiBzdHJva2U9ImJsYWNrIi8+CiAgPGcgY2xhc3M9InZmLXN0YXZlbm90ZSIgaWQ9InN2Z18zNCI+CiAgIDxnIGNsYXNzPSJ2Zi1ub3RlIiBpZD0ic3ZnXzM1Ij4KICAgIDxnIGNsYXNzPSJ2Zi1zdGVtIiBpZD0ic3ZnXzM2Ij4KICAgICA8cGF0aCBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0ibTczLjYzODY3LDEwMWwwLC02NyIgaWQ9InN2Z18zNyIvPgogICAgPC9nPgogICAgPGcgY2xhc3M9InZmLW5vdGVoZWFkIiBpZD0ic3ZnXzM4IiBzdHJva2U9Im51bGwiPgogICAgIDxyZWN0IHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgeD0iNjAuNjM4Njc1IiB5PSIxMDMiIHdpZHRoPSIxNS41IiBoZWlnaHQ9IjAuNSIgaWQ9InN2Z18zOSIgc3Ryb2tlPSJibGFjayIvPgogICAgIDxwYXRoIHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgZD0ibTYzLjYzODY3LDEwM202LjYwMjQsLTQuNjg3MmMwLjEwMDgsMCAwLjI1MiwwIDAuMjc3MiwwYzAsMCAwLjAyNTIxLDAgMC4wMjUyMSwwYzAsMCAwLjE1MTE5LDAgMC4yNzcxOSwwYzIuMjY4LDAuMTI2IDMuNjAzNiwxLjYxMjggMy42MDM2LDMuNDc3NmMwLDAuOTA3MiAtMC4zMDI0LDEuOTQwNCAtMS4wNTg0LDIuOTIzMmMtMS40MzY0LDEuOTQwNCAtMy43OCwyLjk5ODggLTUuODIxMiwyLjk5ODhjLTEuNTg3NiwwIC0yLjk0ODQsLTAuNjMgLTMuNjAzNiwtMS45MTUyYy0wLjIwMTYsLTAuNTA0IC0wLjMwMjQsLTAuOTgyOCAtMC4zMDI0LC0xLjUxMmMwLC0yLjc0NjggMy4wNzQ0MSwtNS43OTYgNi42MDI0LC01Ljk3MjQiIGlkPSJzdmdfNDAiLz4KICAgIDwvZz4KICAgIDxnIGNsYXNzPSJ2Zi1ub3RlaGVhZCIgaWQ9InN2Z180MSI+CiAgICAgPHBhdGggc3Ryb2tlLXdpZHRoPSIwLjMiIGZpbGw9ImJsYWNrIiBkPSJtNjMuNjM4NjcsOTNtNi42MDI0LC00LjY4NzJjMC4xMDA4LDAgMC4yNTIsMCAwLjI3NzIsMGMwLDAgMC4wMjUyMSwwIDAuMDI1MjEsMGMwLDAgMC4xNTExOSwwIDAuMjc3MTksMGMyLjI2OCwwLjEyNiAzLjYwMzYsMS42MTI4IDMuNjAzNiwzLjQ3NzZjMCwwLjkwNzIgLTAuMzAyNCwxLjk0MDQgLTEuMDU4NCwyLjkyMzJjLTEuNDM2NCwxLjk0MDQgLTMuNzgsMi45OTg4IC01LjgyMTIsMi45OTg4Yy0xLjU4NzYsMCAtMi45NDg0LC0wLjYzIC0zLjYwMzYsLTEuOTE1MmMtMC4yMDE2LC0wLjUwNCAtMC4zMDI0LC0wLjk4MjggLTAuMzAyNCwtMS41MTJjMCwtMi43NDY4IDMuMDc0NDEsLTUuNzk2IDYuNjAyNCwtNS45NzI0IiBpZD0ic3ZnXzQyIi8+CiAgICA8L2c+CiAgICA8ZyBjbGFzcz0idmYtbm90ZWhlYWQiIGlkPSJzdmdfNDMiPgogICAgIDxwYXRoIHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgZD0ibTYzLjYzODY3LDgzbTYuNjAyNCwtNC42ODcyYzAuMTAwOCwwIDAuMjUyLDAgMC4yNzcyLDBjMCwwIDAuMDI1MjEsMCAwLjAyNTIxLDBjMCwwIDAuMTUxMTksMCAwLjI3NzE5LDBjMi4yNjgsMC4xMjYgMy42MDM2LDEuNjEyOCAzLjYwMzYsMy40Nzc2YzAsMC45MDcyIC0wLjMwMjQsMS45NDA0IC0xLjA1ODQsMi45MjMyYy0xLjQzNjQsMS45NDA0IC0zLjc4LDIuOTk4OCAtNS44MjEyLDIuOTk4OGMtMS41ODc2LDAgLTIuOTQ4NCwtMC42MyAtMy42MDM2LC0xLjkxNTJjLTAuMjAxNiwtMC41MDQgLTAuMzAyNCwtMC45ODI4IC0wLjMwMjQsLTEuNTEyYzAsLTIuNzQ2OCAzLjA3NDQxLC01Ljc5NiA2LjYwMjQsLTUuOTcyNCIgaWQ9InN2Z180NCIvPgogICAgPC9nPgogICAgPGcgY2xhc3M9InZmLW5vdGVoZWFkIiBpZD0ic3ZnXzQ1Ij4KICAgICA8cGF0aCBzdHJva2Utd2lkdGg9IjAuMyIgZmlsbD0iYmxhY2siIGQ9Im02My42Mzg2Nyw2OG02LjYwMjQsLTQuNjg3MmMwLjEwMDgsMCAwLjI1MiwwIDAuMjc3MiwwYzAsMCAwLjAyNTIxLDAgMC4wMjUyMSwwYzAsMCAwLjE1MTE5LDAgMC4yNzcxOSwwYzIuMjY4LDAuMTI2IDMuNjAzNiwxLjYxMjggMy42MDM2LDMuNDc3NmMwLDAuOTA3MiAtMC4zMDI0LDEuOTQwNCAtMS4wNTg0LDIuOTIzMmMtMS40MzY0LDEuOTQwNCAtMy43OCwyLjk5ODggLTUuODIxMiwyLjk5ODhjLTEuNTg3NiwwIC0yLjk0ODQsLTAuNjMgLTMuNjAzNiwtMS45MTUyYy0wLjIwMTYsLTAuNTA0IC0wLjMwMjQsLTAuOTgyOCAtMC4zMDI0LC0xLjUxMmMwLC0yLjc0NjggMy4wNzQ0MSwtNS43OTYgNi42MDI0LC01Ljk3MjQiIGlkPSJzdmdfNDYiLz4KICAgIDwvZz4KICAgPC9nPgogICA8ZyBjbGFzcz0idmYtbW9kaWZpZXJzIiBpZD0ic3ZnXzQ3Ii8+CiAgPC9nPgogIDxyZWN0IHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgeD0iNjEuMjI1NzU5IiB5PSI5Mi4wNDEwOTYiIHdpZHRoPSIxNS41IiBoZWlnaHQ9IjAuNSIgaWQ9InN2Z181MSIvPgogIDxyZWN0IHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgeD0iNjEuMjI1NzU5IiB5PSI1MiIgd2lkdGg9IjE1LjUiIGhlaWdodD0iMC41IiBpZD0ic3ZnXzUyIi8+CiAgPHJlY3Qgc3Ryb2tlLXdpZHRoPSIwLjMiIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiB4PSI0NSIgeT0iNzIiIHdpZHRoPSI1MCIgaGVpZ2h0PSIwLjUiIGlkPSJzdmdfNTMiLz4KICA8cmVjdCBzdHJva2Utd2lkdGg9IjAuMyIgZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHg9IjQ1IiB5PSI2MiIgd2lkdGg9IjUwIiBoZWlnaHQ9IjAuNSIgaWQ9InN2Z181NCIvPgogIDxyZWN0IHN0cm9rZS13aWR0aD0iMC4zIiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgeD0iNjEuMjI1NzU5IiB5PSI4MiIgd2lkdGg9IjE1LjUiIGhlaWdodD0iMC41IiBpZD0ic3ZnXzEiLz4KIDwvZz4KPC9zdmc+"},GD1q:function(t,e){},HxsN:function(t,e){},Jkaq:function(t,e){},LEIy:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("/5sW"),a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",{attrs:{id:"inspire"}},[e("v-main",{staticStyle:{position:"absolute",top:"0",bottom:"32px",left:"0",right:"0"}},[e("router-view")],1),this._v(" "),e("v-footer",{staticClass:"justify-center",staticStyle:{height:"32px"},attrs:{absolute:""}},[e("router-link",{attrs:{to:"/"}},[this._v("Sing Together Again")]),this._v(" "),e("router-link",{staticClass:"ml-5 mr-5",attrs:{to:"/about"}},[this._v("About")]),this._v(" "),e("router-link",{attrs:{to:"/contributing"}},[this._v("Contribute")])],1)],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},a,!1,function(t){n("V86l")},null,null).exports,r=n("/ocq"),s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{staticClass:"elevation-12",attrs:{align:"center"}},[n("v-card-title",{staticClass:"indigo white--text"},[t._v("Join Room")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-card-text",[n("v-form",[n("v-text-field",{attrs:{label:"Room ID",name:"Room ID",type:"text"},model:{value:t.roomId,callback:function(e){t.roomId=e},expression:"roomId"}}),t._v(" "),n("v-text-field",{attrs:{label:"Your Name",name:"Your Name",type:"text"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),t._v(" "),n("v-card-actions",{staticClass:"justify-center"},[n("v-btn",{attrs:{large:""},on:{click:function(e){return t.$emit("cancel")}}},[t._v("Back")]),t._v(" "),n("v-btn",{attrs:{color:"primary",large:""},on:{click:function(e){return t.$emit("submit",t.roomId,t.name)}}},[t._v("Join")])],1)],1)},staticRenderFns:[]};var c=n("VU/8")({name:"JoinInsert",data:function(){return{roomId:this.$route.params.hasOwnProperty("prefill")?this.$route.params.prefill:"",name:""}}},s,!1,function(t){n("HxsN")},"data-v-17657333",null).exports,l={name:"Welcome",components:{JoinInsert:c},data:function(){return{msg:"Welcome to Your Vue.js App",joinDialogShown:!1}},methods:{join:function(t,e){this.$router.push("/calibrate/"+t+"/"+encodeURIComponent(e))}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-content",[i("v-card",{staticClass:"mx-auto text-center pb-10",attrs:{fluid:""}},[i("div",{staticClass:"central-title d-flex justify-center align-center mb-4 pt-10"},[i("div",[i("img",{attrs:{src:n("FUWc")}})]),t._v(" "),i("h1",{staticClass:"text--primary ml-2"},[t._v("\n        Sing Together Again\n      ")])]),t._v(" "),i("v-card-text",[i("h3",{staticClass:"headline"},[t._v("Sing repeated songs together in harmony online. Everyone hears everyone else's previous repetition.")])]),t._v(" "),i("v-card-actions",{staticClass:"pt-10 pb-10 justify-center"},[i("v-dialog",{attrs:{width:"500px"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,a=e.attrs;return[i("v-btn",t._g(t._b({attrs:{color:"primary",large:""}},"v-btn",a,!1),n),[t._v("\n              Join Room\n            ")])]}}]),model:{value:t.joinDialogShown,callback:function(e){t.joinDialogShown=e},expression:"joinDialogShown"}},[t._v(" "),i("JoinInsert",{on:{submit:function(e,n){return t.join(e,n)},cancel:function(e){t.joinDialogShown=!1}}})],1),t._v(" "),i("v-btn",{staticClass:"ml-5",attrs:{to:"create",large:""}},[t._v("Create Room")])],1)],1)],1)},staticRenderFns:[]};var d=n("VU/8")(l,u,!1,function(t){n("Jkaq")},"data-v-dfea2e22",null).exports,v={name:"Welcome",data:function(){return{roomId:this.$route.params.hasOwnProperty("prefill")?this.$route.params.prefill:"",name:""}},components:{JoinInsert:c},methods:{join:function(t,e){this.$router.push("/calibrate/"+t+"/"+encodeURIComponent(e))}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[n("JoinInsert",{on:{submit:function(e,n){return t.join(e,n)},cancel:function(t){return this.$router.push("/")}}})],1)],1)],1)},staticRenderFns:[]};var f=n("VU/8")(v,g,!1,function(t){n("T3Yu")},"data-v-852eb3ba",null).exports,m=n("//Fk"),h=n.n(m),p=n("d7EF"),I=n.n(p),M=n("Zrlr"),w=n.n(M),y=n("wxAW"),C=n.n(y),b=0,j=1,x=2,N=3,D=4,_=5,A=6,L=function(){function t(){w()(this,t),this.underlying=new Uint8Array(1),this.length=0}return C()(t,[{key:"extend",value:function(){var t=new Uint8Array(2*this.underlying.length);t.subarray(0,this.underlying.length).set(this.underlying),this.underlying=t}},{key:"appendInt",value:function(t){this.length+1>=this.underlying.length&&this.extend(),this.underlying[this.length]=t,this.length+=1}},{key:"appendArray",value:function(t){for(;this.length+t.length>=this.underlying.length;)this.extend();this.underlying.subarray(this.length,this.length+t.length).set(t),this.length+=t.length}},{key:"extract",value:function(){return this.underlying.slice(0,this.length)}}]),t}();function S(t,e){0===t?e.appendInt(0):(e.appendInt(t%256),S(t>>8,e))}function z(t,e){for(var n=0,i=0;0!==e[t];)n+=e[t]<<8*i,i+=1,t+=1;return[t+1,n]}function T(t,e){S(t.length,e),e.appendArray(t)}function k(t,e){var n,i=z(t,e),a=I()(i,2);return[(t=a[0])+(n=a[1]),e.subarray(t,t+n)]}var Z=new TextEncoder("utf-8"),Y=new TextDecoder("utf-8");function E(t,e){return T(Z.encode(t),e)}function P(t,e){var n,i=k(t,e),a=I()(i,2);return t=a[0],n=a[1],[t,Y.decode(n)]}function U(t,e){t?e.appendInt(1):e.appendInt(0)}function R(t,e){return[t+1,1===e[t]]}function G(t,e){"number"==typeof t?(e.appendInt(A),function(t,e){U(t<0,e),S(Math.abs(t),e)}(t,e)):"string"==typeof t?(e.appendInt(x),E(t,e)):"boolean"==typeof t?(e.appendInt(N),U(t,e)):t instanceof ArrayBuffer?(t=new Uint8Array(t),e.appendInt(j),T(t,e)):t instanceof Uint8Array?(e.appendInt(j),T(t,e)):t instanceof Array?(e.appendInt(D),function(t,e){S(t.length,e);for(var n=0;n<t.length;n++)G(t[n],e)}(t,e)):t instanceof Object&&(e.appendInt(_),function(t,e){var n=0;for(var i in t)t.hasOwnProperty(i)&&(n+=1);for(var a in S(n,e),t)t.hasOwnProperty(a)&&(E(a,e),G(t[a],e))}(t,e))}function O(t,e){if(e[t]===b)return z(t+1,e);if(e[t]===j)return k(t+1,e);if(e[t]===x)return P(t+1,e);if(e[t]===N)return R(t+1,e);if(e[t]===D)return function(t,e){var n,i=void 0,a=[],o=z(t,e),r=I()(o,2);t=r[0],n=r[1];for(var s=0;s<n;s++){var c=O(t,e),l=I()(c,2);t=l[0],i=l[1],a.push(i)}return[t,a]}(t+1,e);if(e[t]===_)return function(t,e){var n,i=void 0,a=void 0,o={},r=z(t,e),s=I()(r,2);t=s[0],n=s[1];for(var c=0;c<n;c++){var l=P(t,e),u=I()(l,2);t=u[0],i=u[1];var d=O(t,e),v=I()(d,2);t=v[0],a=v[1],o[i]=a}return[t,o]}(t+1,e);if(e[t]===A)return function(t,e){var n,i=R(t,e),a=I()(i,2);t=a[0],n=a[1];var o=z(t,e),r=I()(o,2);return[t=r[0],r[1]*(n?-1:1)]}(t+1,e);throw new Error("invalid type "+e[t])}var W={encode:function(t){var e=new L;return G(t,e),e.extract()},decode:function(t){var e=0,n=O(e,t),i=I()(n,2);return e=i[0],i[1]}};function B(t){var e=[];for(var n in t)e.push(n+"="+encodeURIComponent(t[n]));return"?"+e.join("&")}var J={get:function(t,e){var n=new XMLHttpRequest;return n.open("GET",t+B(e),!0),n.responseType="arraybuffer",new h.a(function(t,e){n.addEventListener("load",function(){t(W.decode(new Uint8Array(n.response)))}),n.addEventListener("error",e),n.send()})},post:function(t,e,n){var i=new XMLHttpRequest;return i.open("POST",t+B(e),!0),i.responseType="arraybuffer",new h.a(function(t,e){i.addEventListener("load",function(){t(W.decode(new Uint8Array(i.response)))}),i.addEventListener("error",e),i.send(new Blob([W.encode(n).buffer]))})}},Q={name:"Upload",props:["context"],data:function(){return{hasSound:!1,name:"",credits:"",file:null,fileFormat:null,sourceNode:null,timeRange:[0,0],fullDuration:0}},methods:{reclip:function(){this.sourceNode.loopStart=this.timeRange[0],this.sourceNode.loopEnd=this.timeRange[1]},submit:function(){var t=this;this.sourceNode.stop(),this.file.arrayBuffer().then(function(e){J.post("/api/new-song",{},{audio:e,format:t.fileFormat,name:t.name,credits:t.credits,"start-time":Math.round(1e3*t.timeRange[0]),"end-time":Math.round(1e3*t.timeRange[1])}).then(function(){console.log("finishing submission"),t.$emit("submit")})})},processFile:function(t){var e=this,n=t.name,i=n.substr(n.indexOf(".")+1);this.file=t,this.fileFormat=i,t.arrayBuffer().then(function(t){e.context.decodeAudioData(t,function(t){e.sourceNode=e.context.createBufferSource(),e.sourceNode.buffer=t,e.sourceNode.loop=!0,e.sourceNode.loopStart=0,e.sourceNode.loopEnd=t.duration,e.sourceNode.connect(e.context.destination),e.sourceNode.start(),e.timeRange=[0,t.duration],e.fullDuration=t.duration,e.hasSound=!0})})}}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[t._v("Upload an accompaniment")]),t._v(" "),n("v-card-text",[n("v-form",[n("v-file-input",{ref:"input",on:{change:function(e){return t.processFile(e)}}}),t._v(" "),t.hasSound?n("div",[n("div",[t._v("Cut and finish:")]),t._v(" "),n("v-range-slider",{attrs:{"thumb-label":"always",step:"0.01",min:"0",max:t.fullDuration},on:{end:function(e){return t.reclip()}},model:{value:t.timeRange,callback:function(e){t.timeRange=e},expression:"timeRange"}}),t._v(" "),n("v-text-field",{attrs:{label:"Name of song"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),n("v-textarea",{attrs:{label:"Credits"},model:{value:t.credits,callback:function(e){t.credits=e},expression:"credits"}}),t._v(" "),n("v-btn",{on:{click:function(e){return t.$emit("cancel")}}},[t._v("Cancel")]),t._v(" "),n("v-btn",{attrs:{color:"primary"},on:{click:function(e){return t.submit()}}},[t._v("Submit")])],1):t._e()],1)],1)],1)},staticRenderFns:[]};var F={name:"CreatingBulletinElement",props:["value","songs","context"],watch:{value:function(){this.$emit("input",this.value)}},components:{Upload:n("VU/8")(Q,H,!1,function(t){n("opwk")},"data-v-33224aee",null).exports},data:function(){return{dialogShown:!1,uploadShown:!1,songDict:{}}},methods:{finishUpload:function(){console.log("finishing upload now"),this.uploadShown=!1,this.$emit("upload")}},created:function(){var t=this;this.songs.forEach(function(e){t.songDict[e.id]=e})}},$={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-form",[n("div",{staticClass:"text-left"},[n("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{color:"blue lighten-2",dark:""}},"v-btn",a,!1),i),[t._v("\n          Select Song\n        ")])]}}]),model:{value:t.dialogShown,callback:function(e){t.dialogShown=e},expression:"dialogShown"}},[t._v(" "),n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[t._v("\n          Select a Song\n        ")]),t._v(" "),n("v-card-text",[n("v-list",[n("v-list-item-group",{on:{change:function(e){t.dialogShown=!1}},model:{value:t.value.song,callback:function(e){t.$set(t.value,"song",e)},expression:"value.song"}},[n("v-list-item",{key:-1,attrs:{value:-1}},[n("v-list-item-content",[n("v-list-item-title",[t._v("No song")])],1)],1),t._v(" "),t._l(t.songs,function(e){return n("v-list-item",{key:e.id,attrs:{value:e.id}},[n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e.name+" ("+e.id+")")}})],1)],1)})],2)],1)],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",{staticClass:"justify-center"},[n("v-btn",{on:{click:function(e){t.dialogShown=!1}}},[t._v("Cancel")]),t._v(" "),n("v-dialog",{attrs:{width:"500",model:"uploadShown"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({},"v-btn",a,!1),i),[t._v("\n                  Upload New\n                ")])]}}])},[t._v(" "),n("Upload",{attrs:{context:t.context},on:{cancel:function(e){t.uploadShown=!1},submit:function(e){return t.finishUpload()}}})],1)],1)],1)],1),t._v(" "),-1!==t.value.song?n("span",[t._v("\n      Song: "+t._s(t.songDict[t.value.song].name)+" ("+t._s(t.value.song)+")\n    ")]):t._e(),t._v(" "),-1===t.value.song?n("span",[t._v("\n    No song\n    ")]):t._e()],1),t._v(" "),n("v-text-field",{attrs:{label:"Section Title",name:"Section Title",type:"text"},model:{value:t.value.title,callback:function(e){t.$set(t.value,"title",e)},expression:"value.title"}}),t._v(" "),n("v-textarea",{attrs:{label:"Additional text for this section",name:"Additional text for this section",type:"text"},model:{value:t.value.description,callback:function(e){t.$set(t.value,"description",e)},expression:"value.description"}}),t._v(" "),n("v-divider",{staticClass:"pb-5"})],1)},staticRenderFns:[]};var X={name:"Sing",props:["context"],components:{CreatingBulletinElement:n("VU/8")(F,$,!1,function(t){n("zdHs")},"data-v-1cf3c217",null).exports},data:function(){return{bulletin:[],knownSongs:[]}},methods:{addSection:function(){this.bulletin.push({title:"",song:-1,description:""})},submit:function(){var t=this;J.post("/api/create-room",{},this.bulletin).then(function(e){t.$router.push("/join/"+e.room_id)})},refetchSongs:function(){var t=this;J.get("/api/song-list",{}).then(function(e){t.knownSongs=e})}},created:function(){var t=this;J.get("/api/song-list",{}).then(function(e){t.knownSongs=e})}},V={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("v-col",{staticClass:"fill-height",attrs:{cols:"10",sm:"10",md:"10"}},[n("v-card",{staticClass:"elevation-12",staticStyle:{position:"relative"},attrs:{height:"100%",align:"center"}},[n("v-card-title",{ref:"header",staticClass:"indigo white--text",staticStyle:{position:"absolute",top:"0",left:"0",right:"0"},attrs:{dark:"",flat:""}},[t._v("\n            Create the Order of Service\n          ")]),t._v(" "),n("v-card-text",{staticStyle:{position:"absolute",top:"64px",bottom:"64px",padding:"10px",overflow:"auto"}},[t._l(t.bulletin,function(e,i){return n("CreatingBulletinElement",{key:i,attrs:{context:t.context,songs:t.knownSongs},on:{upload:function(e){return t.refetchSongs()}},model:{value:t.bulletin[i],callback:function(e){t.$set(t.bulletin,i,e)},expression:"bulletin[i]"}})}),t._v(" "),n("v-btn",{attrs:{large:""},on:{click:function(e){return t.addSection()}}},[t._v("Add section")])],2),t._v(" "),n("v-card-actions",{ref:"footer",staticClass:"justify-center indigo white--text",staticStyle:{position:"absolute",bottom:"0",left:"0",right:"0"}},[n("v-btn",{attrs:{to:"/",large:""}},[t._v("Cancel")]),t._v(" "),n("v-btn",{attrs:{large:"",color:"primary"},on:{click:function(e){return t.submit()}}},[t._v("Done")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var K=n("VU/8")(X,V,!1,function(t){n("GD1q")},"data-v-79f38dec",null).exports,q=null;function tt(){return null!=q?h.a.resolve(q):navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(t){return q=t,t})}function et(t){t=t.clone();var e=new MediaRecorder(t,{mimeType:"audio/webm"}),n=[];return e.addEventListener("dataavailable",function(t){t.data.size>0&&n.push(t.data)}),e.start(),{stop:function(){return e.stop()},data:new h.a(function(t,i){e.addEventListener("stop",function(e){t(new Response(n[0]).arrayBuffer())})})}}function nt(t,e,n){var i=t.createBufferSource();i.buffer=e,i.connect(t.destination),n<t.currentTime?i.start(0,t.currentTime-n):i.start(n)}function it(t,e){for(var n=t.createBuffer(2,t.sampleRate*e,t.sampleRate),i=0;i<n.numberOfChannels;i++)for(var a=n.getChannelData(i),o=0;o<n.length;o++)a[o]=Math.sin(2*Math.PI*o*440/t.sampleRate);return n}function at(t,e,n,i){return new h.a(function(a,o){!function o(){var r;n-t.currentTime<.5?(r=et(e),a(h.a.all([r.data,n-t.currentTime])),setTimeout(r.stop,1e3*(i-t.currentTime)+100)):setTimeout(o,100)}()})}var ot={getMediaStream:tt,recordMedia:et,playAudioBuffer:nt,createOscillatorBuffer:it,recordAtTime:at,measureLatency:function(t){var e=t.currentTime+1,n=it(t,.5);return tt().then(function(i){return nt(t,n,e),at(t,i,e,e+1)}).then(function(e){var n=I()(e,2),i=n[0],a=n[1];return h.a.all([t.decodeAudioData(i),a])}).then(function(t){for(var e=I()(t,2),n=e[0],i=e[1],a=n.getChannelData(0),o=Math.max.apply(window,a),r=Math.min.apply(window,a),s=Math.min(Math.abs(o)/2,Math.abs(r)/2),c=Math.round(n.sampleRate*i),l=c+1*n.sampleRate;;){for(var u=c;u<l;u++)if(Math.abs(a[u])>s)return(u-c)/n.sampleRate;s/=2}})}},rt={name:"Sing",props:["context"],data:function(){return{bulletin:[],users:[],roomId:this.$route.params.room,name:decodeURIComponent(this.$route.params.user),roomSinging:!1,schedulers:{},songs:{},advanceMessage:"Begin service",index:-1,userId:""}},methods:{advance:function(){this.singing?J.get("/api/stop-song",{room_id:this.roomId}):J.get("/api/start-song",{room_id:this.roomId,index:this.index+1})}},created:function(){var t=this;ot.getMediaStream().then(function(e){J.get("/api/get-bulletin",{room_id:t.roomId}).then(function(e){t.bulletin=e}),J.get("/api/join-room",{room_id:t.roomId,name:t.name}).then(function(e){t.userId=e.user_id,n()});var n=function n(){J.get("/api/heartbeat",{user_id:t.userId}).then(function(i){t.singing=i.singing,t.index=i.index,t.users=i.users,t.singing?t.advanceMessage="Stop singing":t.index+1<t.bulletin.length&&(console.log(t.index+1,t.bulletin,t.bulletin[t.index+1]),t.advanceMessage="Start "+t.bulletin[t.index+1].title),t.schedulers[t.index]||function n(i,a,o){t.schedulers[i]=!0,i<0||t.bulletin[i].song<0||J.get("/api/get-mixed",{room_id:t.roomId,user_id:t.userId,index:i,parity:a}).then(function(e){return t.context.decodeAudioData(e.audio.buffer)}).then(function(r){return setTimeout(function(){0===a||i===t.index&&t.singing?n(i,(a+1)%2,o+r.duration):t.schedulers[i]=!1},1e3*(o+r.duration-t.context.currentTime)-2e3),ot.playAudioBuffer(t.context,r,o),ot.recordAtTime(t.context,e,o,o+r.duration)}).then(function(e){var n=I()(e,2),o=n[0],r=n[1];return r+=t.$store.state.latency,J.post("/api/submit-audio",{user_id:t.userId,index:i,parity:a},{audio:o,offset:r})})}(t.index,0,t.context.currentTime),setTimeout(n,1500)})}})}},st={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{staticClass:"fill-height",attrs:{align:"center",justify:"center"}},[n("v-col",{staticClass:"fill-height",attrs:{cols:"10",sm:"10",md:"10"}},[n("v-card",{staticClass:"elevation-12 fill-height",attrs:{align:"center"}},[n("v-card-title",{staticClass:"indigo white--text",staticStyle:{position:"absolute",top:"0",left:"0",right:"0"}},[t._v("Room "+t._s(t.$route.params.room))]),t._v(" "),n("v-spacer"),t._v(" "),n("v-card-text",{staticStyle:{position:"absolute",top:"64px",bottom:"64px"}},[n("v-container",{staticClass:"fill-height"},[n("v-row",{staticClass:"fill-height"},[n("v-col",{staticClass:"fill-height",attrs:{cols:"3"}},[n("v-card",{staticClass:"fill-height"},[n("v-card-title",{attrs:{light:"",flat:""}},[t._v("Participants")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[n("v-list",{attrs:{disabled:""}},[n("v-list-item-group",{model:{value:t.userId,callback:function(e){t.userId=e},expression:"userId"}},t._l(t.users,function(e){return n("v-list-item",{key:e.id},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-account")])],1),t._v(" "),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(e.name)}})],1)],1)}),1)],1)],1)],1)],1),t._v(" "),n("v-col",{staticClass:"fill-height",attrs:{cols:"9"}},[n("v-card",{staticClass:"fill-height overflow-y-auto"},[n("v-card-title",[t._v("Bulletin")]),t._v(" "),n("v-divider"),t._v(" "),n("v-card-text",[n("v-list",{attrs:{disabled:""}},[n("v-list-item-group",{model:{value:t.index,callback:function(e){t.index=e},expression:"index"}},t._l(t.bulletin,function(e,i){return n("v-list-item",{key:i},[n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:t._s(i+1+". "+e.title)}}),t._v(" "),n("div",{staticClass:"justify-left"},[t._v(t._s(e.description))])],1)],1)}),1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),n("v-divider"),t._v(" "),n("v-card-actions",{staticClass:"justify-center indigo white--text",staticStyle:{position:"absolute",bottom:"0",left:"0",right:"0"}},[n("v-btn",{on:{click:function(e){return t.advance()}}},[t._v(t._s(t.advanceMessage))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ct=n("VU/8")(rt,st,!1,function(t){n("fbiz")},"data-v-3fbccea5",null).exports,lt={name:"Calibrate",props:["context"],data:function(){return{measurements:[],room:this.$route.params.room,user:this.$route.params.user,finished:!1}},methods:{calibrate:function(){var t=this;this.measurements=[];for(var e=h.a.resolve(-1),n=0;n<9;n++)e=e.then(function(e){return e>0&&t.measurements.push(e),ot.measureLatency(t.context)});e.then(function(e){t.measurements.push(e),t.$store.commit("setLatency",t.measurements.sort()[4]),t.finished=!0})}}},ut={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center",justify:"center"}},[n("v-col",{attrs:{cols:"12",sm:"8",md:"4"}},[n("v-card",{staticClass:"elevation-12",attrs:{align:"center"}},[n("v-card-title",{staticClass:"indigo white--text"},[t._v("Calibrate audio latency")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-card-text",[t.finished?t._e():n("div",[t._v('\n          Hold your headphones up to your microphone and click "calibrate". This will take about 15 seconds.\n          ')]),t._v(" "),t.finished?n("div",[t._v("\n          We estimate your audio latency to be around "+t._s(t.$store.state.latency.toPrecision(3))+' seconds. Click "continue", or, if something went wrong, hold your headphones up to your micrphone and click "recalibrate".\n          ')]):t._e(),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",large:""},on:{click:function(e){return t.calibrate()}}},[t._v(t._s(t.finished?"Recalibrate":"Calibrate"))])],1),t._v(" "),n("v-card-actions",{staticClass:"justify-center"},[n("v-btn",{attrs:{to:"/join",large:""}},[t._v("Back")]),t._v(" "),n("v-btn",{attrs:{disabled:!t.finished,to:"/sing/"+t.room+"/"+t.user,color:"success",large:""}},[t._v("Continue")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var dt=n("VU/8")(lt,ut,!1,function(t){n("LEIy")},"data-v-b180e1f4",null).exports,vt={name:"Welcome",components:{JoinInsert:c},data:function(){return{msg:"Welcome to Your Vue.js App",joinDialogShown:!1}},methods:{join:function(t,e){this.$router.push("/calibrate/"+t+"/"+encodeURIComponent(e))}}},gt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-content",[i("v-card",{staticClass:"mx-auto text-center pb-10",attrs:{fluid:""}},[i("div",{staticClass:"central-title d-flex justify-center align-center mb-4 pt-10"},[i("div",[i("img",{attrs:{src:n("FUWc")}})]),t._v(" "),i("h1",{staticClass:"text--primary ml-2"},[t._v("\n        About\n      ")])]),t._v(" "),i("v-card-text",{staticStyle:{"text-align":"left"}},[i("p",[t._v("Sing Together Again was originally written by Anthony Bau in an effort to find a way for Taize at MIT to sing together again during the COVID-19 lockdown in 2020. It is built with congregational singing in mind, but can be used for any situation where a group of people want to sing something in harmony repeatedly.")]),t._v(" "),i("p",[t._v("If a group wants to sing together with Sing Together Again, they'll first need to get, in advance, some accompaniment or leading voice to record one playthrough of each song they will sing. This will serve to ground the rhythm of the group and ensure everyone remains in time. Then one person will create a room and load these recordings into the order of service. They'll then distribute the room ID so everyone else can join.")]),t._v(" "),i("p",[t._v("When singing, everyone will first hear just the recorded accompaniment/leader, and should begin singing along to it immediately. After one full playthrough, everyone will begin to hear everyone else's voices in harmony; these voices are taken from the previous repetition.")])])],1)],1)},staticRenderFns:[]};var ft=n("VU/8")(vt,gt,!1,function(t){n("NpDn")},"data-v-0332ca6a",null).exports,mt={name:"Welcome",components:{JoinInsert:c},data:function(){return{msg:"Welcome to Your Vue.js App",joinDialogShown:!1}},methods:{join:function(t,e){this.$router.push("/calibrate/"+t+"/"+encodeURIComponent(e))}}},ht={render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-content",[e("v-card",{staticClass:"mx-auto text-center pb-10",attrs:{fluid:""}},[e("div",{staticClass:"central-title d-flex justify-center align-center mb-4 pt-10"},[e("div",[e("img",{attrs:{src:n("FUWc")}})]),this._v(" "),e("h1",{staticClass:"text--primary ml-2"},[this._v("\n        Contribute\n      ")])]),this._v(" "),e("v-card-text",{staticStyle:{"text-align":"left"}},[this._v("\n      If you are a developer with time, this project is on Github at "),e("a",{attrs:{href:"https://github.com/dabbler0/sing-together-again-rewrite"}},[this._v("sing-together-again-rewrite")]),this._v(". As of right now I am still actively maintaining it and am open to Github issues or pull requests.\n    ")])],1)],1)},staticRenderFns:[]};var pt=n("VU/8")(mt,ht,!1,function(t){n("A0Cv")},"data-v-626db78c",null).exports;i.default.use(r.a);var It=new AudioContext,Mt=new r.a({routes:[{path:"/",name:"Welcome",component:d},{path:"/about",name:"About",component:ft},{path:"/contributing",name:"Contributing",component:pt},{path:"/join",name:"Join",component:f},{path:"/join/:prefill",name:"JoinPrefilled",component:f},{path:"/create",name:"Create",props:{context:It},component:K},{path:"/sing/:room/:user",name:"Sing",props:{context:It},component:ct},{path:"/calibrate/:room/:user",name:"Calibrate",props:{context:It},component:dt}]}),wt=n("NYxO");i.default.use(wt.a);var yt=new wt.a.Store({state:{latency:0},mutations:{setLatency:function(t,e){t.latency=e}},actions:{},getters:{}}),Ct=n("3EgV"),bt=n.n(Ct);n("7zck");i.default.use(bt.a),i.default.config.productionTip=!1,new i.default({el:"#app",router:Mt,store:yt,vuetify:new bt.a,render:function(t){return t(o)}})},NpDn:function(t,e){},T3Yu:function(t,e){},V86l:function(t,e){},fbiz:function(t,e){},opwk:function(t,e){},zdHs:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7c37baaa8d83a29a9db7.js.map